<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="punto-venta">
    <div class="section-header">
        <h2><i class="fas fa-cash-register"></i> Punto de Venta</h2>
        <div class="acciones-cabecera">
        </div>
    </div>

    <div class="contenedor-pos">
        <div class="panel-productos">
            <div class="busqueda-productos">
                <input type="text" class="form-control" placeholder="Buscar productos..." id="buscar-productos">
                <button class="btn btn-primary btn-sm" id="btn-buscar">
                    <i class="fas fa-search"></i>
                </button>
            </div>

            <div class="filtros-categoria">
                <a th:href="@{/caja(section='punto-venta', categoria='todos')}" class="btn btn-primary btn-sm">Todos</a>
                <a th:each="cat : ${categorias}"
                   th:text="${cat.nombre}"
                   th:href="@{/caja(section='punto-venta', categoria=${cat.nombre})}"
                   class="btn btn-primary btn-sm"></a>
            </div>

			<div class="grid-productos">
			    <div th:each="menu : ${menus}" 
			         class="producto-card"
			         th:data-id="${menu.id}"
			         th:data-nombre="${menu.nombreProducto}"
			         th:data-precio="${menu.precio}">
			        <img th:src="@{${menu.imagen}}" alt="Producto">
			        <h4 th:text="${menu.nombreProducto}"></h4>
			        <p th:text="${menu.descripcion}"></p>
			        <p th:text="${#strings.concat('$', #numbers.formatDecimal(menu.precio, 0, 'POINT', 0, 'POINT'))}"></p>

			        <button class="btn btn-success btn-sm btn-agregar">
			            <i class="fas fa-cart-plus"></i> Agregar
			        </button>
			    </div> 
			</div>
        </div>

        <div class="panel-carrito">
            <div class="cabecera-carrito">
                <h3><i class="fas fa-shopping-cart"></i> Carrito</h3>
                <button class="btn btn-outline-danger btn-sm" id="btn-vaciar-carrito">
                    <i class="fas fa-trash-alt"></i>
                </button>
            </div>

            <div class="items-carrito" id="items-carrito"></div>

            <div class="total-carrito">
                <span>Total:</span>
                <span id="total-carrito">$0.00</span>
            </div>

            <div class="acciones-carrito">
                <button class="btn btn-secondary" id="btn-imprimir">
                    <i class="fas fa-print"></i> Imprimir
                </button>
                <button class="btn btn-success" id="btn-finalizar-venta">
                    <i class="fas fa-check"></i> Finalizar Venta
                </button>
            </div>
        </div>
    </div>
	<!-- Modal Métodos de Pago y Clientes Frecuentes -->
	<div class="modal fade" id="metodosPagoModal" tabindex="-1" aria-hidden="true">
	    <div class="modal-dialog modal-lg">
	        <div class="modal-content">
	            <div class="modal-header">
	                <h5 class="modal-title">Métodos de pago</h5>
	                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
	            </div>
	            <div class="modal-body">
	                <!-- Métodos de pago -->
	                <div class="mb-3">
	                    <h6 class="mb-2">Seleccione método de pago</h6>
	                    <div class="d-flex flex-wrap gap-2">
	                        <button type="button" class="btn btn-outline-primary" data-metodo="TARJETA">
	                            Tarjeta
	                        </button>
	                        <button type="button" class="btn btn-outline-primary" data-metodo="EFECTIVO">
	                            Efectivo
	                        </button>
	                        <button type="button" class="btn btn-outline-primary" data-metodo="TRANSFERENCIA">
	                            Transferencia
	                        </button>
	                        <button type="button" class="btn btn-outline-primary" data-metodo="MIXTO">
	                            Mixto
	                        </button>
	                    </div>
	                </div>
	                <hr>
	                <!-- Clientes frecuentes -->
	                <div>
	                    <h6 class="mb-2">Clientes frecuentes</h6>
						<div class="table-responsive">
						          <table class="table table-striped table-hover align-middle text-center">
						              <thead class="table-dark">
						              <tr>
						                  <th>Nombre</th>
										  <th>Nota</th>
										   <th>Consumo</th>
						              </tr>
						              </thead>
						              <tbody id="clientesFrecuentesTableBody">
						              <tr th:each="c : ${clientes}" data-row>
						                  <td th:text="${c.nombre}"></td>
						                  <td>
						                      <span th:text="${c.nota != null ? c.nota : '—'}"></span>
						                  </td>
						                  <td>
											<td>
											    <button type="button"
											            class="btn btn-success btn-sm rounded-pill px-3 btn-pagar-con-abono"
											            th:data-cliente-id="${c.id}"
											            th:data-cliente-nombre="${c.nombre}">
											        <i class="fas fa-check"></i> Pagar
											    </button>
											</td>
						                  </td>
						              </tr>
						              <tr th:if="${clientes == null or clientes.isEmpty()}">
						                  <td colspan="8" class="text-center py-4 text-muted">
						                      <i class="fas fa-id-card fa-2x mb-3"></i>
						                      <p>No hay clientes frecuentes registrados.</p>
						                  </td>
						              </tr>
						              </tbody>
						          </table>
	                </div>
	            </div>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-success">
	                    Confirmar
	                </button>
	                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
	                    Cancelar
	                </button>
	            </div>
	        </div>
	    </div>
	</div>
</div>
</body>
</html>
