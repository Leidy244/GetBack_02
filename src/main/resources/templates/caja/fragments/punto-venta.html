<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<body>
	<div th:fragment="punto-venta">
		<div class="section-header">
			<h2><i class="fas fa-cash-register"></i> Punto de Venta</h2>
			<div class="acciones-cabecera">
			</div>
		</div>

		<div class="contenedor-pos">
			<div class="panel-productos">
				<div class="busqueda-productos">
					<input type="text" class="form-control" placeholder="Buscar productos..." id="buscar-productos">
					<button class="btn btn-primary btn-sm" id="btn-buscar">
						<i class="fas fa-search"></i>
					</button>
				</div>
				<div class="filtros-categoria">
					<a th:href="@{/caja(section='punto-venta', categoria='todos')}"
						class="btn btn-primary btn-sm">Todos</a>
					<a th:each="cat : ${categorias}" th:text="${cat.nombre}"
						th:href="@{/caja(section='punto-venta', categoria=${cat.nombre})}"
						class="btn btn-primary btn-sm"></a>
				</div>
				<div class="grid-productos">
					<div th:each="menu : ${menus}" class="producto-card" th:data-id="${menu.id}"
						th:data-nombre="${menu.nombreProducto}" th:data-precio="${menu.precio}">
						<img th:src="@{${menu.imagen}}" alt="Producto">
						<h4 th:text="${menu.nombreProducto}"></h4>
						<p th:text="${menu.descripcion}"></p>
						<p
							th:text="${#strings.concat('$', #numbers.formatDecimal(menu.precio, 0, 'POINT', 0, 'POINT'))}">
						</p>
						<button class="btn btn-success btn-sm btn-agregar">
							<i class="fas fa-cart-plus"></i> Agregar
						</button>
					</div>
				</div>
			</div>
			<div class="panel-carrito">
				<div class="cabecera-carrito">
					<h3><i class="fas fa-shopping-cart"></i> Carrito</h3>
					<button class="btn btn-outline-danger btn-sm" id="btn-vaciar-carrito">
						<i class="fas fa-trash-alt"></i>
					</button>
				</div>

				<div class="items-carrito" id="items-carrito"></div>

				<div class="total-carrito">
					<span>Total:</span>
					<span id="total-carrito">$0.00</span>
				</div>

				<div class="acciones-carrito">
					<button class="btn btn-secondary" id="btn-imprimir">
						<i class="fas fa-print"></i> Imprimir
					</button>
					<button class="btn btn-success" id="btn-finalizar-venta">
						<i class="fas fa-check"></i> Finalizar Venta
					</button>
				</div>
			</div>
		</div>
		
		<!-- Modal Confirmar Venta -->
		<div class="modal fade" id="modalConfirmarVenta" tabindex="-1">
		    <div class="modal-dialog modal-lg">
		        <div class="modal-content">
		            <div class="modal-header bg-primary text-white">
		                <h5 class="modal-title">Confirmar Pedido</h5>
		                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
		            </div>
		            <div class="modal-body">
		                <!-- Selector de Mesa -->
		                <div class="mb-4">
		                    <label class="form-label fw-bold"> Seleccionar Mesa</label>
		                    <select class="form-select" id="select-mesa-venta">
		                        <option value="">-- Bar (Mostrador) --</option>
		                        <!-- Las mesas se cargarán dinámicamente con JavaScript -->
		                    </select>
		                    <div class="form-text">Selecciona una mesa o deja "Bar" para pedidos en mostrador</div>
		                </div>

		                <!-- Detalles del Pedido -->
		                <div class="border rounded p-3 mb-3">
		                    <h6 class="fw-bold mb-3"> Detalles del Pedido</h6>
		                    <div class="table-responsive">
		                        <table class="table table-sm">
		                            <thead>
		                                <tr>
		                                    <th class="text-center">Cant</th>
		                                    <th>Producto</th>
		                                    <th class="text-end">Precio</th>
		                                    <th class="text-end">Subtotal</th>
		                                </tr>
		                            </thead>
		                            <tbody id="detalle-venta-modal">
		                                <!-- Los items se cargan dinámicamente -->
		                            </tbody>
		                            <tfoot>
		                                <tr class="table-success">
		                                    <td colspan="3" class="text-end fw-bold">TOTAL:</td>
		                                    <td class="text-end fw-bold" id="total-modal">$0</td>
		                                </tr>
		                            </tfoot>
		                        </table>
		                    </div>
		                </div>
		            </div>
		            <div class="modal-footer">
		                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
		                <button type="button" class="btn btn-success" id="btn-confirmar-venta-real">
		                    ✅ Confirmar Pedido Pendiente
		                </button>
		            </div>
		        </div>
		    </div>
		</div>
</body>
<script th:src="@{/js/puntoVenta.js}"></script>
</html>