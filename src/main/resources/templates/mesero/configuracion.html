<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Perfil del Mesero</title>
	<link rel="stylesheet" th:href="@{/css/configuracionMesero.css}">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
	<header class="header">
		<div class="logo-desktop">
			<a th:href="@{/configuracion}">
				<img th:src="@{~/images/Logo_principal.png}" width="100" alt="Logo Get Back">
			</a>
		</div>
		<h2> Perfil del Mesero</h2>
		<!-- Contenedor principal de botones de navegación -->
		<div class="container">
			<nav class="nav-btn-wrapper" aria-label="Menú de configuración del mesero">

				<a th:href="@{/mesero}" class="nav-btn">
					<i class="fa-solid fa-utensils"></i>
					<span>Tomar Pedido</span>
				</a>
				<a th:href="@{/PerfilMesero}" class="nav-btn">
					<i class="fas fa-user"></i>
					<span>Perfil</span>
				</a>

				<a th:href="@{/estadisticas}" class="nav-btn">
					<i class="fas fa-chart-bar"></i>
					<span>Estadísticas</span>
				</a>


				<a th:href="@{/historial}" class="nav-btn">
					<i class="fas fa-history"></i>
					<span>Historial</span>
				</a>
				<a th:href="@{/configuracionMesero}" class="nav-btn">
					<i class="fa-solid fa-gear"></i>
					<span>Configuración</span>
				</a>

				<a th:href="@{/login}" class="nav-btn">
					<i class="fa-solid fa-arrow-right-from-bracket"></i>
					<span>Cerrar sessión</span>
				</a>
			</nav>
		</div>




	</header>

	<!-- Información -->
	<div class="content-col">
		<div class="content-card">
			<div class="card-body">
				<div class="account-info">
					<div class="user-display">
						<!-- FOTO -->
						<div class="avatar" id="avatar">
							<img th:if="${session.usuarioLogueado.foto != null}"
								th:src="@{'/images/' + ${session.usuarioLogueado.foto}}" alt="Foto de perfil" />
							<div th:if="${session.usuarioLogueado.foto == null}" class="avatar-placeholder">
								<span th:text="${#strings.substring(session.usuarioLogueado.nombre,0,1) + 
											#strings.substring(session.usuarioLogueado.apellido,0,1)}">AD</span>
							</div>
						</div>

						<!-- DATOS -->
						<div class="user-details">
							<h3 th:text="${session.usuarioLogueado.nombre + ' ' + session.usuarioLogueado.apellido}">
							</h3>
							<p th:text="${session.usuarioLogueado.correo}"></p>
							<p th:text="${session.usuarioLogueado.telefono}"></p>
							<p th:text="${session.usuarioLogueado.direccion}"></p>
							<small>Último acceso: <span id="ultimo-acceso">Hoy</span></small>
						</div>

						<!-- BOTONES -->
						<div class="account-actions" style="display:flex; gap:10px; margin-left:auto;">
							<button type="button" id="btnEditProfile" class="dropdown-item">
								<i class="fas fa-user-edit"></i> Editar Perfil
							</button>
							<button type="button" id="btnChangePhoto" class="dropdown-item">
								<i class="fas fa-camera"></i> Cambiar Foto
							</button>
						</div>
					</div>

					<!-- FORMULARIO EDITAR -->
					<form id="formEditar" th:action="@{/actualizar-datos-mesero}" method="post" style="display:none;">
						<input type="hidden" name="id" th:value="${session.usuarioLogueado.id}" />

						<label>Nombres:</label>
						<input type="text" name="nombre" th:value="${session.usuarioLogueado.nombre}" />

						<label>Apellidos:</label>
						<input type="text" name="apellido" th:value="${session.usuarioLogueado.apellido}" />

						<label>Correo:</label>
						<input type="email" name="correo" th:value="${session.usuarioLogueado.correo}" />

						<label>Dirección:</label>
						<input type="text" name="direccion" th:value="${session.usuarioLogueado.direccion}" />

						<label>Teléfono:</label>
						<input type="text" name="telefono" th:value="${session.usuarioLogueado.telefono}" />

						<label>Clave:</label>
						<input type="password" name="clave" th:value="${session.usuarioLogueado.clave}" />

						<div style="margin-top:10px; display:flex; gap:10px;">
							<button type="submit" class="btn">Guardar cambios</button>
							<button type="button" id="btnCancelEdit" class="btn ghost">Cancelar</button>
						</div>
					</form>


					<!-- FORMULARIO FOTO -->
					<div id="formFoto" style="display:none; margin-top:20px;">
						<div class="card">
							<form th:action="@{/actualizar-foto-mesero}" method="post" enctype="multipart/form-data">
								<input type="hidden" name="id" th:value="${session.usuarioLogueado.id}" />

								<input type="file" id="inputFoto" name="foto" accept="image/*" required
									style="display:none;" />

								<label for="inputFoto" class="btnArchivo">Seleccionar imagen</label>
								<span id="nombreArchivo" class="nombre-archivo">Ningún archivo seleccionado</span>
								<br>
								<div style="margin-top:10px; display:flex; gap:10px;">
									<button type="submit" class="btnGuardarFoto">Actualizar Foto</button>
									<button type="button" id="cancelFoto" class="btnCancelarFoto">Cancelar</button>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Botón Modo Oscuro -->
	<button class="dark-mode-toggle" id="darkModeToggle">
		<i class="fas fa-moon"></i>
	</button>

</body>

<script th:src="@{/js/ConfigMesero.js}" defer>

</script>

</html>