<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Perfil del Mesero</title>
	<link rel="stylesheet" th:href="@{/css/perfil.css}">
</head>

<body>
	<header class="header">
		<h2>üßë‚Äçüç≥ Perfil del Mesero</h2>
	</header>

	<main class="perfil-container">
		<section class="perfil-card">

			<div class="user-details">
				<h3 th:text="${session.usuarioLogueado.nombre}"></h3>
				<p th:text="${session.usuarioLogueado.correo}"></p>
				<p th:text="${session.usuarioLogueado.telefono}"></p>
				<p th:text="${session.usuarioLogueado.direccion}"></p>
				<small>√öltimo acceso: <span id="ultimo-acceso">Hoy</span></small>
			</div>
			<div class="account-actions">
				<button type="button" id="btnEditProfile" class="dropdown-item"><i class="fas fa-user-edit"></i> Editar
					Perfil
				</button>
				<button class="btn ghost" id="btnChangePhoto">Cambiar foto</button>
			</div>
			<!--------Formulario editar informacion-->
			<div id="formEditar" style="display:none; margin-top:20px;">
				<div class="card">

					<form th:action="@{/actualizar-datos}" th:object="${session.usuarioLogueado}" method="post">
						<input type="hidden" th:field="*{id}" />

						<label>Nombres:</label>
						<input type="text" th:field="*{nombre}" />

						<label>Apellidos:</label>
						<input type="text" th:field="*{apellido}" />

						<label>Correo:</label>
						<input type="email" th:field="*{correo}" />

						<label>Direcci√≥n:</label>
						<input type="text" th:field="*{direccion}" />

						<label>Tel√©fono:</label>
						<input type="text" th:field="*{telefono}" />

						<label>Clave:</label>
						<input type="password" th:field="*{clave}" />

						<button type="submit">Guardar cambios</button>
						<button type="button" id="btnCancelEdit">Cancelar</button>
					</form>

				</div>
			</div>

		</section>
	</main>
</body>
<script>
	// Referencias a los formularios
	const formEditar = document.getElementById("formEditar");
	const formFoto = document.getElementById("formFoto");

	// Botones
	const btnEditProfile = document.getElementById("btnEditProfile");
	const btnChangePhoto = document.getElementById("btnChangePhoto");
	const btnCancelEdit = document.getElementById("btnCancelEdit");
	const btnCancelFoto = document.getElementById("cancelFoto");

	// --- Abrir Formulario de Edici√≥n ---
	btnEditProfile.addEventListener("click", () => {
		// Cierra el de foto si est√° abierto
		formFoto.style.display = "none";

		// Alterna el de edici√≥n
		formEditar.style.display = formEditar.style.display === "block" ? "none" : "block";
	});

	// --- Abrir Formulario de Foto ---
	btnChangePhoto.addEventListener("click", () => {
		// Cierra el de edici√≥n si est√° abierto
		formEditar.style.display = "none";

		// Alterna el de foto
		formFoto.style.display = formFoto.style.display === "block" ? "none" : "block";
	});

	// --- Cerrar ambos ---
	btnCancelEdit.addEventListener("click", () => {
		formEditar.style.display = "none";
	});

	btnCancelFoto?.addEventListener("click", () => {
		formFoto.style.display = "none";
	});

	// --- Nombre de la imagen seleccionada ---
	document.addEventListener("DOMContentLoaded", () => {
		const inputFoto = document.getElementById("inputFoto");
		const nombreArchivo = document.getElementById("nombreArchivo");

		if (inputFoto && nombreArchivo) {
			inputFoto.addEventListener("change", () => {
				const archivo = inputFoto.files[0];
				nombreArchivo.textContent = archivo
					? archivo.name
					: "Ning√∫n archivo seleccionado";
			});
		}
	});
</script>

</html>