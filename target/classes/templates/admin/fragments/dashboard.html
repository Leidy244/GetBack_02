<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Panel de Control</title>
    <link rel="stylesheet" href="/admin-styles.css">
    <link rel="stylesheet" href="/dashboard-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .dashboard-container {
            padding: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .dashboard-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .dashboard-header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5rem;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1rem;
        }

        .dashboard-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .stat-card-compact {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border-left: 4px solid #3498db;
            transition: transform 0.3s ease;
        }

        .stat-card-compact:hover {
            transform: translateY(-2px);
        }

        .stat-content {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
        }

        .sales { background: #e74c3c; }
        .income { background: #27ae60; }
        .pending { background: #f39c12; }
        .products { background: #9b59b6; }
        .categories { background: #3498db; }
        .events { background: #1abc9c; }
        .users { background: #34495e; }
        .tables { background: #d35400; }

        .stat-info {
            flex: 1;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 1rem;
            color: #7f8c8d;
            margin-bottom: 5px;
        }

        .stat-description {
            font-size: 0.9rem;
            color: #95a5a6;
        }

        .charts-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .charts-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .charts-header h3 {
            color: #2c3e50;
            margin: 0;
            font-size: 1.5rem;
        }

        .chart-filters {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .chart-filter-btn {
            padding: 8px 16px;
            background: #ecf0f1;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            color: #7f8c8d;
        }

        .chart-filter-btn:hover {
            background: #d5dbdb;
        }

        .chart-filter-btn.active {
            background: #3498db;
            color: white;
        }

        .charts-container {
            display: none;
        }

        .charts-container.active {
            display: block;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 25px;
        }

        .chart-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .chart-card.full-width {
            grid-column: 1 / -1;
        }

        .chart-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chart-img {
            width: 100%;
            height: auto;
            border-radius: 8px;
            display: block;
        }

        @media (max-width: 768px) {
            .dashboard-stats-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-grid {
                grid-template-columns: 1fr;
            }
            
            .charts-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
<section th:fragment="dashboard" class="content-section">
    <div class="dashboard-container">

        <!-- Header -->
        <div class="dashboard-header">
            <h1>Panel de Control</h1>
            <p class="subtitle">Resumen general del sistema</p>
        </div>

        <!-- Estadísticas Principales -->
        <div class="dashboard-stats-grid">
            <!-- Ventas Hoy -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon sales"><i class="fas fa-shopping-cart"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="${ventasHoy}">0</div>
                        <div class="stat-label">Ventas Hoy</div>
                        <div class="stat-description" th:text="'$' + ${#numbers.formatDecimal(ingresosHoy, 1, 'COMMA', 2, 'POINT')}">$0.00</div>
                    </div>
                </div>
            </div>

            <!-- Ingresos Totales -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon income"><i class="fas fa-chart-line"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="'$' + ${#numbers.formatDecimal(ingresosTotales, 1, 'COMMA', 2, 'POINT')}">$0.00</div>
                        <div class="stat-label">Ingresos Totales</div>
                        <div class="stat-description" th:text="${totalVentas} + ' ventas'">0 ventas</div>
                    </div>
                </div>
            </div>

            <!-- Pedidos Pendientes -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon pending"><i class="fas fa-clock"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="${pedidosPendientes}">0</div>
                        <div class="stat-label">Pedidos Pendientes</div>
                        <div class="stat-description">Por preparar</div>
                    </div>
                </div>
            </div>

            <!-- Productos -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon products"><i class="fas fa-cocktail"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="${totalProductos}">0</div>
                        <div class="stat-label">Productos</div>
                        <div class="stat-description">En menú</div>
                    </div>
                </div>
            </div>

            <!-- Categorías -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon categories"><i class="fas fa-tags"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="${totalCategorias}">0</div>
                        <div class="stat-label">Categorías</div>
                        <div class="stat-description">Activas</div>
                    </div>
                </div>
            </div>

            <!-- Eventos -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon events"><i class="fas fa-calendar-alt"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="${totalEventos}">0</div>
                        <div class="stat-label">Eventos</div>
                        <div class="stat-description">Programados</div>
                    </div>
                </div>
            </div>

            <!-- Usuarios -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon users"><i class="fas fa-users"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="${totalUsuarios}">0</div>
                        <div class="stat-label">Usuarios</div>
                        <div class="stat-description">Activos</div>
                    </div>
                </div>
            </div>

            <!-- Mesas -->
            <div class="stat-card-compact">
                <div class="stat-content">
                    <div class="stat-icon tables"><i class="fas fa-chair"></i></div>
                    <div class="stat-info">
                        <div class="stat-value" th:text="${totalMesas}">0</div>
                        <div class="stat-label">Mesas</div>
                        <div class="stat-description">Registradas</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Gráficas -->
        <div class="charts-section">
            <div class="charts-header">
                <h3><i class="fas fa-chart-pie"></i> Estadísticas Detalladas</h3>
                <div class="chart-filters">
                    <div class="chart-filter-btn active" data-filter="all">Todos</div>
                    <div class="chart-filter-btn" data-filter="products">Productos</div>
                    <div class="chart-filter-btn" data-filter="categories">Categorías</div>
                    <div class="chart-filter-btn" data-filter="events">Eventos</div>
                    <div class="chart-filter-btn" data-filter="users">Usuarios</div>
                    <div class="chart-filter-btn" data-filter="mesas">Mesas</div>
                </div>
            </div>

            <!-- Todos -->
            <div class="charts-container active" id="charts-all">
                <div class="charts-grid">
                    <div class="chart-card">
                        <div class="chart-title"><i class="fas fa-tags"></i> Productos por Categoría</div>
                        <img th:src="@{${chartCategorias}}" alt="Productos por categoría" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title"><i class="fas fa-calendar"></i> Eventos por Mes</div>
                        <img th:src="@{${chartEventos}}" alt="Eventos por mes" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title"><i class="fas fa-users"></i> Usuarios por Rol</div>
                        <img th:src="@{${chartUsuarios}}" alt="Usuarios por rol" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title"><i class="fas fa-chair"></i> Estado de Mesas</div>
                        <img th:src="@{${chartMesas}}" alt="Estado de mesas" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                </div>
            </div>

            <!-- Productos -->
            <div class="charts-container" id="charts-products">
                <div class="charts-grid">
                    <div class="chart-card full-width">
                        <div class="chart-title"><i class="fas fa-chart-bar"></i> Productos por Categoría</div>
                        <img th:src="@{${chartCategorias}}" alt="Gráfico productos por categoría" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                </div>
            </div>

            <!-- Categorías -->
            <div class="charts-container" id="charts-categories">
                <div class="charts-grid">
                    <div class="chart-card full-width">
                        <div class="chart-title"><i class="fas fa-chart-pie"></i> Distribución de Productos por Categoría</div>
                        <img th:src="@{${chartCategorias}}" alt="Distribución de categorías" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                </div>
            </div>

            <!-- Eventos -->
            <div class="charts-container" id="charts-events">
                <div class="charts-grid">
                    <div class="chart-card full-width">
                        <div class="chart-title"><i class="fas fa-chart-line"></i> Eventos por Mes</div>
                        <img th:src="@{${chartEventos}}" alt="Eventos por mes" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                </div>
            </div>

            <!-- Usuarios -->
            <div class="charts-container" id="charts-users">
                <div class="charts-grid">
                    <div class="chart-card full-width">
                        <div class="chart-title"><i class="fas fa-user-friends"></i> Usuarios por Rol</div>
                        <img th:src="@{${chartUsuarios}}" alt="Usuarios por rol" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                </div>
            </div>

            <!-- Mesas -->
            <div class="charts-container" id="charts-mesas">
                <div class="charts-grid">
                    <div class="chart-card full-width">
                        <div class="chart-title"><i class="fas fa-chair"></i> Estado de Mesas</div>
                        <img th:src="@{${chartMesas}}" alt="Estado de mesas" class="chart-img" 
                             onerror="this.style.display='none'"/>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Script simplificado -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const filterBtns = document.querySelectorAll('.chart-filter-btn');
            const chartContainers = document.querySelectorAll('.charts-container');
            
            filterBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const filter = this.getAttribute('data-filter');
                    
                    // Remover clase active de todos los botones
                    filterBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Ocultar todos los contenedores
                    chartContainers.forEach(c => c.classList.remove('active'));
                    
                    // Mostrar el contenedor objetivo
                    const target = document.getElementById('charts-' + filter);
                    if (target) {
                        target.classList.add('active');
                    }
                });
            });
        });
    </script>
</section>
</body>
</html>